name: Text Snow Rain Matrix

on:
  schedule:
    - cron: "0 7 * * *"
  workflow_dispatch:

jobs:
  generate:
    runs-on: ubuntu-latest

    steps:
      - name: –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Ç–µ–∫—Å—Ç–æ–≤–æ–π —Å—Ü–µ–Ω—ã —Å –ø–µ—Ä—Å–ø–µ–∫—Ç–∏–≤–æ–π
        run: |
          WIDTH=80
          HEIGHT=20

          # —Å–∏–º–≤–æ–ª—ã –Ω–µ–±–∞
          SKY_SMALL="¬∑ Àë Àê Àò Àô üíß"
          SKY_SNOW="‚ùÑ ‚úº ‚ùÖ ‚ùÑÔ∏è"
          SKY_SHINE="‚ãÜ ‚úß ‚≠êÔ∏è"

          # —Ç–∏–ø—ã –¥–æ—Ä–æ–≥–∏
          ROAD_TYPES=("|" "‚îÇ" ":" "‚ñë" "‚ñí")
          ROAD_SYMBOL=${ROAD_TYPES[$RANDOM % ${#ROAD_TYPES[@]}]}

          HORIZON_Y=$((HEIGHT / 3))

          for ((y=1; y<=HEIGHT; y++)); do
              LINE=""

              ROAD_TOP=6
              ROAD_BOTTOM=50

              if [ $y -gt $HORIZON_Y ]; then
                  T=$(( (y - HORIZON_Y) * 100 / (HEIGHT - HORIZON_Y) ))
                  ROAD_WIDTH=$(( ROAD_TOP + (ROAD_BOTTOM - ROAD_TOP) * T / 100 ))
              else
                  ROAD_WIDTH=$ROAD_TOP
              fi

              ROAD_LEFT=$(( (WIDTH - ROAD_WIDTH) / 2 ))
              ROAD_RIGHT=$(( ROAD_LEFT + ROAD_WIDTH ))

              for ((x=1; x<=WIDTH; x++)); do

                  if [ $y -eq $HORIZON_Y ]; then
                      CHAR="‚îÄ"

                  elif [ $y -gt $HORIZON_Y ] && [ $x -ge $ROAD_LEFT ] && [ $x -le $ROAD_RIGHT ]; then
                      if [ $x -eq $(( (ROAD_LEFT + ROAD_RIGHT) / 2 )) ] && [ $((y % 2)) -eq 0 ]; then
                          CHAR="‚îÇ"
                      else
                          CHAR="$ROAD_SYMBOL"
                      fi

                  else
                      R=$((RANDOM % 20))
                      if [ $R -eq 0 ]; then
                          CHAR=$(echo "$SKY_SNOW" | tr " " "\n" | shuf -n 1)
                      elif [ $R -eq 1 ]; then
                          CHAR=$(echo "$SKY_SHINE" | tr " " "\n" | shuf -n 1)
                      else
                          CHAR=$(echo "$SKY_SMALL" | tr " " "\n" | shuf -n 1)
                      fi
                  fi

                  LINE="$LINE$CHAR"
              done

              echo "$LINE"
              sleep 0.05
          done

